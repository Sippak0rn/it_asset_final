<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{ title or "IT Assets Management" }}</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>

<body class="app-body">

  <!-- ✅ Toast Notifications -->
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <div class="toast-stack" data-toast-top="public">
        {% for category, msg in messages %}
          {% set t = 'toast-success' if category=='success' else 'toast-info' if category=='info' else 'toast-warning' if category=='warning' else 'toast-danger' %}
          <div class="toast-item {{ t }}" data-autohide="5000">
            <div class="toast-body">
              <div class="toast-title">
                {{ 'สำเร็จ' if category=='success' else 'แจ้งเตือน' if category=='info' else 'คำเตือน' if category=='warning' else 'ผิดพลาด' }}
              </div>
              <div class="toast-msg">{{ msg }}</div>
            </div>
            <button class="toast-close" type="button" aria-label="Close">×</button>
            <div class="toast-bar"></div>
          </div>
        {% endfor %}
      </div>
    {% endif %}
  {% endwith %}

  <!-- ✅ ไม่มี container/padding เพื่อให้ home กลางจอจริง -->
  {% block content %}{% endblock %}

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- ✅ Auto hide toasts in 5s -->
  <script>
    (function () {
      function hideToast(el) {
        if (!el || el.classList.contains("toast-hide")) return;
        el.classList.add("toast-hide");
        window.setTimeout(function () {
          if (el && el.parentNode) el.parentNode.removeChild(el);
        }, 340);
      }

      document.addEventListener("DOMContentLoaded", function () {
        document.querySelectorAll(".toast-item").forEach(function (toast) {
          var ms = parseInt(toast.getAttribute("data-autohide") || "5000", 10);

          var btn = toast.querySelector(".toast-close");
          if (btn) btn.addEventListener("click", function () { hideToast(toast); });

          window.setTimeout(function () { hideToast(toast); }, ms);
        });
      });
    })();
  </script>

</body>
</html>
